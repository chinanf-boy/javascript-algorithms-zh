
# 弗洛伊德算法

在计算机科学中**弗洛伊德算法**是一种用于可以正确处理有向图或负权（但不可存在负权回路）的最短路径问题. 单次执行算法将找到所有顶点对之间的最短路径的长度 (总和权重) . 虽然它不返回路径本身的细节,但可以通过对算法的简单修改来重建路径. 

## 算法

> 一个有向图G=（V，E）

用邻接矩阵`map[][]`存储有向图，用`dist[i][j]`表示`i`到`j`的最短路径。设`G`的顶点为`V={1,2,3...n}`，对于任意一对顶点`i`,`j`属于`V`，假设`i`到`j`有路径且中间节点皆属于集合`{1,2,3...k}`，`P`是其中的一条最小权值路径。就是`i`到`j`的最短路径`P`所通过的中间顶点最大不超过`k`。

设 <b>D<sub>i,j,k</sub></b> 为从 `i` 到 `j` 的, 只以`(1..k)`集合中的节点为中间节点的最短路径的长度。

1. 若最短路径经过点`k`，则 ![if](http://upload.wikimedia.org/math/e/3/a/e3aee6a3e2a2083164cdfee6f1c9ad03.png)
2. 若最短路径不经过点`k`，则![ele](http://upload.wikimedia.org/math/b/6/f/b6fd348302496399233dce43e708aa21.png)

因此, ![end](http://upload.wikimedia.org/math/c/2/a/c2a0ed091e3e04a32b8563f21dc82df2.png)

这个公式是弗洛伊德算法的核心. 

## 例

上面的算法在左下方的图表上执行: 

![Example](https://upload.wikimedia.org/wikipedia/commons/2/2e/Floyd-Warshall_example.svg)

在下表中`i`是行号和`j`是列号. 

**k = 0**

|       |  1  |  2  |  3  |  4  |
| :---: | :-: | :-: | :-: | :-: |
| **1** |  0  |  ∞  |  -2 |  ∞  |
| **2** |  4  |  0  |  3  |  ∞  |
| **3** |  ∞  |  ∞  |  0  |  2  |
| **4** |  ∞  |  -1 |  ∞  |  0  |

**k = 1**

|       |  1  |  2  |  3  |  4  |
| :---: | :-: | :-: | :-: | :-: |
| **1** |  0  |  ∞  |  -2 |  ∞  |
| **2** |  4  |  0  |  2  |  ∞  |
| **3** |  ∞  |  ∞  |  0  |  2  |
| **4** |  ∞  |  -  |  ∞  |  0  |

**k = 2**

|       |  1  |  2  |  3  |  4  |
| :---: | :-: | :-: | :-: | :-: |
| **1** |  0  |  ∞  |  -2 |  ∞  |
| **2** |  4  |  0  |  2  |  ∞  |
| **3** |  ∞  |  ∞  |  0  |  2  |
| **4** |  3  |  -1 |  1  |  0  |

**k = 3**

|       |  1  |  2  |  3  |  4  |
| :---: | :-: | :-: | :-: | :-: |
| **1** |  0  |  ∞  |  -2 |  0  |
| **2** |  4  |  0  |  2  |  4  |
| **3** |  ∞  |  ∞  |  0  |  2  |
| **4** |  3  |  -1 |  1  |  0  |

**k = 4**

|       |  1  |  2  |  3  |  4  |
| :---: | :-: | :-: | :-: | :-: |
| **1** |  0  |  -1 |  -2 |  0  |
| **2** |  4  |  0  |  2  |  4  |
| **3** |  5  |  1  |  0  |  2  |
| **4** |  3  |  -1 |  1  |  0  |

## 参考

-   [Wikipedia](https://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)
-   [YouTube (by Abdul Bari)](https://www.youtube.com/watch?v=oNI0rf2P9gE&list=PLLXdhg_r2hKA7DPDsunoDZ-Z769jWn4R8&index=74)
-   [YouTube (by Tushar Roy)](https://www.youtube.com/watch?v=LwJdNfdLF9s&list=PLLXdhg_r2hKA7DPDsunoDZ-Z769jWn4R8&index=75)
